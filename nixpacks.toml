[phases.setup]
# ติดตั้ง Node.js 20, Python 3.9, และ Tesseract OCR สำหรับ OCR system
nixPkgs = ['nodejs_20', 'python39', 'python39Packages.pip', 'tesseract']
aptPkgs = ['libgl1', 'libglib2.0-0', 'libsm6', 'libxext6', 'libxrender-dev', 'libgomp1']

[phases.install]
# ติดตั้ง Node.js dependencies ใน petizo folder
cmds = ['cd petizo && npm install']

[phases.build]
# ติดตั้ง Python packages ตอน build (ไม่มี timeout เพราะ Nixpacks เร็ว)
cmds = [
  'cd petizo/ocr_system && python3 -m pip install --break-system-packages --upgrade pip',
  'cd petizo/ocr_system && python3 -m pip install --break-system-packages -r requirements.txt'
]

[start]
# เริ่ม server จากโฟลเดอร์ petizo - start.sh จะติดตั้ง Python packages ถ้ายังไม่มี
cmd = 'cd petizo && chmod +x start.sh && ./start.sh'
